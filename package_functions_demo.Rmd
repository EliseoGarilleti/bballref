---
title: "bballref Package - Complete Function Reference"
output: html_document
date: "`r Sys.Date()`"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(devtools)
load_all()
library(dplyr)
library(knitr)
```

# bballref Package - Complete Function Reference

This document demonstrates all functions available in the bballref package with examples and sample output.

---

# 1. Player Functions

## 1.1 player_per_game()

Get per game statistics for a player across all seasons.

```{r player_per_game}
# Get LeBron James per game stats
lebron_pg <- player_per_game("LeBron James")

# Show first 10 seasons
head(lebron_pg, 10)
```

**Total seasons:** `r nrow(lebron_pg)`

---

## 1.2 player_totals()

Get season totals for a player.

```{r player_totals}
# Get Stephen Curry totals
curry_totals <- player_totals("Stephen Curry")

# Show first 10 seasons
head(curry_totals, 10)
```

**Total seasons:** `r nrow(curry_totals)`

---

## 1.3 player_per_minute()

Get per 36 minutes statistics.

```{r player_per_minute}
# Get Giannis per 36 stats
giannis_per36 <- player_per_minute("Giannis Antetokounmpo")

# Show first 8 seasons
head(giannis_per36, 10) 
```

**Total seasons:** `r nrow(giannis_per36)`

---

## 1.4 player_advanced()

Get advanced statistics (PER, TS%, WS, etc.).

```{r player_advanced}
# Get Kevin Durant advanced stats
durant_adv <- player_advanced("Kevin Durant")

# Show first 8 seasons
head(durant_adv, 10)
```

**Total seasons:** `r nrow(durant_adv)`

---

## 1.5 player_per_poss()

Get per 100 possessions statistics. Note: Player search is accent-insensitive.

```{r player_per_poss}
# Get Nikola Jokic per 100 poss stats (works with or without accent)
jokic_poss <- player_per_poss("Nikola Jokic")

# Show all seasons
head(jokic_poss, 10)
```

**Total seasons:** `r nrow(jokic_poss)`

---

## 1.6 player_shooting()

Get shooting statistics by distance and zone.

```{r player_shooting}
# Get Stephen Curry shooting stats
curry_shoot <- player_shooting("Stephen Curry")

# Show recent 5 seasons
head(curry_shoot, 5)
```

**Total seasons:** `r nrow(curry_shoot)`

---

## 1.7 player_pbp()

Get play-by-play statistics.

```{r player_pbp}
# Get James Harden pbp stats
harden_pbp <- player_pbp("James Harden")

# Show recent 5 seasons
head(harden_pbp, 5)
```

**Total seasons:** `r nrow(harden_pbp)`

---

## 1.8 player_stats_bulk() - NEW

Get career statistics for multiple players at once.

```{r player_bulk}
# Compare LeBron and Jordan
goats <- player_stats_bulk(
  stat_function = player_per_game,
  players = c("LeBron James", "Michael Jordan"),
  season_type = "regular",
  progress = FALSE
)

# Show first 5 seasons for each
goats %>%
  group_by(player) %>%
  slice(1:5) %>%
  select(Season, Age, Tm, G, PTS, AST, TRB, player) %>%
  kable()
```

**Total rows:** `r nrow(goats)`
**Players:** `r paste(unique(goats$player), collapse = ", ")`

---

# 2. Team Functions (Season-Specific)

## 2.1 team_per_game()

Get per game statistics for a team in a specific season.

```{r team_per_game}
# Get Lakers 2020 per game stats
lakers_2020 <- team_per_game("LAL", 2020)

# Show all players
lakers_2020 %>%
  select(Player, Age, G, PTS, AST, TRB) %>%
  kable()
```

**Total players:** `r nrow(lakers_2020)`

---

## 2.2 team_totals()

Get season totals for a team.

```{r team_totals}
# Get Warriors 2022 totals
warriors_2022 <- team_totals("GSW", 2022)

# Show top 10 players by games
head(warriors_2022, 10) %>%
  select(Player, Age, G, PTS, AST, TRB) %>%
  kable()
```

**Total players:** `r nrow(warriors_2022)`

---

## 2.3 team_advanced()

Get advanced statistics for a team.

```{r team_advanced}
# Get Celtics 2024 advanced stats
celtics_adv <- team_advanced("BOS", 2024)

# Show top 10 players by games
head(celtics_adv, 10) %>%
  select(Player, Age, G, PER, WS) %>%
  kable()
```

**Total players:** `r nrow(celtics_adv)`

---

## 2.4 team_roster()

Get roster information for a team.

```{r team_roster}
# Get Heat 2020 roster
heat_roster <- team_roster("MIA", 2020)

# Show all players
heat_roster %>%
  select(Player, Pos, Ht, Wt, Birth_Date) %>%
  kable()
```

**Total players:** `r nrow(heat_roster)`

---

## 2.5 team_per_minute()

Get per 36 minutes statistics for a team.

```{r team_per_minute}
# Get Nuggets 2023 per 36 stats
nuggets_per36 <- team_per_minute("DEN", 2023)

# Show top 10 players
head(nuggets_per36, 10) %>%
  select(Player, Age, G, PTS, AST, TRB) %>%
  kable()
```

**Total players:** `r nrow(nuggets_per36)`

---

## 2.6 team_per_poss()

Get per 100 possessions statistics for a team.

```{r team_per_poss}
# Get Bucks 2021 per 100 poss stats
bucks_poss <- team_per_poss("MIL", 2021)

# Show top 10 players
head(bucks_poss, 10) %>%
  select(Player, Age, G, PTS, AST, TRB) %>%
  kable()
```

**Total players:** `r nrow(bucks_poss)`

---

## 2.7 team_shooting()

Get shooting statistics for a team.

```{r team_shooting}
# Get Warriors 2016 shooting stats
warriors_shoot <- team_shooting("GSW", 2016)

# Show top 10 players
head(warriors_shoot, 10) %>%
  select(Player, Age, G, FGpct, three_Ppct) %>%
  kable()
```

**Total players:** `r nrow(warriors_shoot)`

---

## 2.8 team_pbp()

Get play-by-play statistics for a team.

```{r team_pbp}
# Get Lakers 2020 pbp stats
lakers_pbp <- team_pbp("LAL", 2020)

# Show top 10 players
head(lakers_pbp, 10) %>%
  select(Player, Age, G) %>%
  kable()
```

**Total players:** `r nrow(lakers_pbp)`

---

## 2.9 team_stats_bulk() - NEW

Get statistics for multiple teams and/or years at once.

```{r team_bulk}
# Compare Finals teams 2020: Lakers vs Heat
finals_2020 <- team_stats_bulk(
  stat_function = team_per_game,
  teams = c("LAL", "MIA"),
  years = 2020,
  season_type = "regular",
  progress = FALSE
)

# Show top scorers from each team
finals_2020 %>%
  arrange(team, desc(as.numeric(PTS))) %>%
  group_by(team) %>%
  slice(1:5) %>%
  select(Player, team, G, PTS, AST, TRB) %>%
  kable()
```

**Total rows:** `r nrow(finals_2020)`
**Teams:** `r paste(unique(finals_2020$team), collapse = ", ")`

---

### Example: One Team, Multiple Years

```{r team_bulk_years}
# Get Lakers stats for 3 consecutive years
lakers_3years <- team_stats_bulk(
  stat_function = team_per_game,
  teams = "LAL",
  years = 2022:2024,
  progress = FALSE
)

# Show LeBron's stats across these years
lakers_3years %>%
  filter(grepl("James", Player)) %>%
  select(Player, season, G, PTS, AST, TRB) %>%
  kable()
```

**Total rows:** `r nrow(lakers_3years)`
**Seasons:** `r paste(sort(unique(lakers_3years$season)), collapse = ", ")`

---

# 3. Team Aggregate Functions (Historical)

## 3.1 team_stats_totals()

Get aggregate totals across all seasons in franchise history.

```{r team_agg_totals}
# Get Warriors historical totals
warriors_history <- team_stats_totals("GSW")

# Show most recent 10 seasons
head(warriors_history, 10) %>%
  select(Season, Lg, Tm, W, L, Age) %>%
  kable()
```

**Total seasons:** `r nrow(warriors_history)`

---

## 3.2 team_stats_totals() with Year Filter - NEW

Filter aggregate totals to specific years.

```{r team_agg_totals_filter}
# Get Lakers totals for recent years (2015-2024)
lakers_recent <- team_stats_totals("LAL", years = 2015:2024)

# Show all filtered seasons
lakers_recent %>%
  select(Season, Lg, Tm, W, L, Age) %>%
  kable()
```

**Filtered seasons:** `r nrow(lakers_recent)`

---

## 3.3 team_stats_per_game()

Get aggregate per game stats across all seasons.

```{r team_agg_pg}
# Get Celtics historical per game stats
celtics_history <- team_stats_per_game("BOS")

# Show most recent 10 seasons
head(celtics_history, 10) %>%
  select(Season, Lg, Tm, W, L, Age) %>%
  kable()
```

**Total seasons:** `r nrow(celtics_history)`

---

## 3.4 team_stats_per_game() with Specific Years - NEW

Filter to specific championship years.

```{r team_agg_pg_filter}
# Get Celtics stats for championship years
celtics_champs <- team_stats_per_game("BOS", years = c(2008, 2024))

# Show all filtered seasons
celtics_champs %>%
  select(Season, Lg, Tm, W, L, Age) %>%
  kable()
```

**Filtered seasons:** `r nrow(celtics_champs)`

---

# 4. League Functions

## 4.1 league_per_game()

Get historical NBA league per game averages.

```{r league_pg}
# Get league per game averages
league_avg <- league_per_game()

# Show most recent 10 seasons
head(league_avg, 10) %>%
  select(Season, Tm, G, PTS, AST, TRB, FGpct) %>%
  kable()
```

**Total seasons:** `r nrow(league_avg)`

---

## 4.2 league_totals()

Get historical NBA league totals.

```{r league_totals}
# Get league totals
league_tots <- league_totals()

# Show most recent 10 seasons
head(league_tots, 10) %>%
  select(Season, Tm, G, PTS, AST, TRB) %>%
  kable()
```

**Total seasons:** `r nrow(league_tots)`

---

## 4.3 league_per_poss()

Get historical NBA league per 100 possessions stats.

```{r league_poss}
# Get league per 100 poss stats
league_p100 <- league_per_poss()

# Show most recent 10 seasons
head(league_p100, 10) %>%
  select(Season, Tm, G, PTS, AST, TRB) %>%
  kable()
```

**Total seasons:** `r nrow(league_p100)`

---

# 5. Championship Data

## 5.1 champions()

Get NBA championship history.

```{r champions_all}
# Get all champions
all_champs <- champions()

# Show most recent 10 championships
head(all_champs, 10) %>%
  select(Year, Champion, team) %>%
  kable()
```

**Total championships:** `r nrow(all_champs)`

---

## 5.2 champions() with Year Range

Filter champions to specific years.

```{r champions_filter}
# Get champions from 2010-2020
champs_2010s <- champions(first_year = 2010, last_year = 2020)

# Show all
champs_2010s %>%
  select(Year, Champion, team) %>%
  kable()
```

**Championships in range:** `r nrow(champs_2010s)`

---

# 6. Playoff Statistics Examples

All player and team functions support `season_type = "playoffs"`.

## 6.1 Player Playoff Stats

```{r player_playoffs}
# Get LeBron playoff stats
lebron_playoffs <- player_per_game("LeBron James", season_type = "playoffs")

# Show first 10 seasons
head(lebron_playoffs, 10) %>%
  select(Season, Age, Tm, G, PTS, AST, TRB) %>%
  kable()
```

**Playoff seasons:** `r nrow(lebron_playoffs)`

---

## 6.2 Team Playoff Stats

```{r team_playoffs}
# Get Lakers 2020 playoff stats
lakers_playoffs <- team_per_game("LAL", 2020, season_type = "playoffs")

# Show all players
lakers_playoffs %>%
  select(Player, Age, G, PTS, AST, TRB) %>%
  kable()
```

**Playoff roster:** `r nrow(lakers_playoffs)`

---

# Summary

## Total Functions: 24

### Player Functions (8):
1. `player_per_game()` - Per game stats
2. `player_totals()` - Season totals
3. `player_per_minute()` - Per 36 minutes
4. `player_per_poss()` - Per 100 possessions
5. `player_advanced()` - Advanced stats
6. `player_shooting()` - Shooting by distance
7. `player_pbp()` - Play-by-play
8. `player_stats_bulk()` - **NEW** - Multiple players

### Team Functions (11):
**Season-Specific (8):**
1. `team_per_game()` - Per game stats
2. `team_totals()` - Season totals
3. `team_advanced()` - Advanced stats
4. `team_roster()` - Roster info
5. `team_per_minute()` - Per 36 minutes
6. `team_per_poss()` - Per 100 possessions
7. `team_shooting()` - Shooting stats
8. `team_pbp()` - Play-by-play

**Historical/Aggregate (3):**
9. `team_stats_totals()` - Historical totals (**Enhanced** with year filter)
10. `team_stats_per_game()` - Historical per game (**Enhanced** with year filter)
11. `team_stats_bulk()` - **NEW** - Multiple teams/years

### League Functions (3):
1. `league_per_game()` - League per game averages
2. `league_totals()` - League totals
3. `league_per_poss()` - League per 100 poss

### Championship Data (1):
1. `champions()` - NBA championship history

### Season Type Support
All player and team functions support `season_type` parameter:
- `"regular"` - Regular season (default)
- `"playoffs"` - Postseason

---

# New Features Summary

## 1. Bulk Functions
- `team_stats_bulk()` - Fetch multiple teams/years at once
- `player_stats_bulk()` - Fetch multiple players at once

## 2. Year Filtering
- `team_stats_totals(team, years)` - Filter historical data
- `team_stats_per_game(team, years)` - Filter historical data

## 3. Benefits
- Reduces code repetition
- Automatic data combination
- Progress tracking
- Error handling
- Cleaner analysis workflows
